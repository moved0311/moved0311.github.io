{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023-03-02-publish-to-gitlab/Publish to gitlab registry/","result":{"data":{"site":{"siteMetadata":{"title":"Taiyi's Blog"}},"markdownRemark":{"id":"2c4dc846-0200-53d8-96a5-5cc786aded1c","excerpt":"要怎麼把公司UI共用元件庫打包發佈讓所有專案能夠使用又不希望上傳到公開的元件庫？ 一般下載套件如使用yarn作為套件管理工具都是到公開元件 https://yarnpkg.com/ 做下載，但公司的東西不希望放到公開的地方，希望能夠放到自己的機器上。目前公司是將所有程式碼都存放在自己架Gitlab…","htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"要怎麼把公司UI共用元件庫打包發佈讓所有專案能夠使用又不希望上傳到公開的元件庫？"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"一般下載套件如使用yarn作為套件管理工具都是到公開元件 "},{"type":"element","tagName":"a","properties":{"href":"https://yarnpkg.com/"},"children":[{"type":"text","value":"https://yarnpkg.com/"}]},{"type":"text","value":" 做下載，但公司的東西不希望放到公開的地方，希望能夠放到自己的機器上。目前公司是將所有程式碼都存放在自己架Gitlab機器上。"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"前端的共用UI元件庫要怎麼推到Gitlab上，並可以從Gitlab做下載呢？"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nGitlab有提供Packages & Registries(圖1)讓套件上傳的空間。配合CICD每次push或增加tag時能夠一併做發佈的動作(圖2)"}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"圖1"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"圖2"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 412px; margin-left: 0; margin-right: 0;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/a8e70500ea43e2483688bcba4018d7dc/9e32a/registry.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 70.94594594594594%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAACKElEQVQ4y51T2W7aUBD1/39CXhIBUZRIyVsSqUpZUoWSBGSWYiM2Y4wX8IaxgcDL6Z1x7Qa16kMfjmbumblzj2fG0uFwAOHjI7X/i+PxiP1+D0lVTXHYYbfbIo432G4TJEnMoHNm4zjlKJ75v/NibDYbRFEEqd3WoWkmWq0RVisPum7BtldYLJZwXQ+O4zKfcg7Hl0uXfdNcwjAczgmCAOv1GpKimKhWuygWa1BVHbe33xl3dw1cX7/g4qKKp6c27u+bqFS6KJWeUSzV0jyR8/DQYl/XbaHyl0Lf9zGfOyyZXvH9AGG4ZgUE8jOO4vO5LdT77KexMI9Jb29jUTmA53mMMPSF/BTkE3yf+IAt8VEUsnVdl+F5mfUgvdQV0RNb9MTEdKqj3x9jONQwGEwxmcwY4/GMeYoTryhjwetCvXkCx3Eg1euqaLotDjZkeYCrq5ro3TOjUKzg/PwrymUZZ2dfcHlZRaFQxs3NNzw+vothzsWw7D8Luq7DCm3bYhjGApaVKiaFxFmWhdFIE/0zOKZpOt8hnpAXbLWmYo/W4vv9fPS0U4Rs77JhpTuYxmj3wjDkgdK9DJIsz0TiRlyI+CVVVYWqCVtFURi6rqPX6wn8EP0dMjca0d6u8scy5AVp7CS53+8zOp0OQ5ZlvkyPNBoNvL6+otvtcowEUEFSmhdsNjUuSHuWfS59ToYkST61IDmJpXsYnkAyDE/81DtO/huyop+L/Sv3Jww0BVf09sOiAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Packages & Registries","title":"Packages & Registries","src":"/static/a8e70500ea43e2483688bcba4018d7dc/9e32a/registry.png","srcSet":["/static/a8e70500ea43e2483688bcba4018d7dc/12f09/registry.png 148w","/static/a8e70500ea43e2483688bcba4018d7dc/e4a3f/registry.png 295w","/static/a8e70500ea43e2483688bcba4018d7dc/9e32a/registry.png 412w"],"sizes":["(max-width:","412px)","100vw,","412px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; margin-left: 0; margin-right: 0;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/6a7003a68f988e5b4593bcd01c8de722/f349c/registry1.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 26.351351351351354%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAArklEQVQY042QyQ7DIAxE+f9fzCWXXLJAgAQMWaa21VRJ1UMtPYExMzaYvu/RNA3atkXXdfg3zvP8cM+N916NZF2W5UGMESEExCUh5F25DL7NrzClFBWJQc4ZRAyvKaU3K8N5LgxB7tdatSYa0R7Hodq6bTCykWc753RK7wNcJC1ud9hEqG+ICPM8YxwGWNaurN353EhBDKWTTsQNVtoff/QLCRlgGkdM1iLbCagFLxmkhXsfW4BKAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Packages & Registries","title":"Packages & Registries","src":"/static/6a7003a68f988e5b4593bcd01c8de722/fcda8/registry1.png","srcSet":["/static/6a7003a68f988e5b4593bcd01c8de722/12f09/registry1.png 148w","/static/6a7003a68f988e5b4593bcd01c8de722/e4a3f/registry1.png 295w","/static/6a7003a68f988e5b4593bcd01c8de722/fcda8/registry1.png 590w","/static/6a7003a68f988e5b4593bcd01c8de722/efc66/registry1.png 885w","/static/6a7003a68f988e5b4593bcd01c8de722/c83ae/registry1.png 1180w","/static/6a7003a68f988e5b4593bcd01c8de722/f349c/registry1.png 2002w"],"sizes":["(max-width:","590px)","100vw,","590px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]}]}]}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"之前做法"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"直接把原始碼與編譯後的檔案推到Gitlab上，然後增加tag來區分不同版本。"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"plain"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-plain"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-plain"]},"children":[{"type":"text","value":"yarn add https://<gitlab-url>/fe-common-library.git#3.89.0"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"直接把整包放到node_modules中，會造成node_modules裡面包了其實用不到的原始碼。"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"node_modules迷因"}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; margin-left: 0; margin-right: 0;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/a8023e440fa3cb4d7a930c3c378db219/4b190/nodeModules.jpg","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 71.62162162162163%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB21LEUkP/xAAaEAACAwEBAAAAAAAAAAAAAAABAgARIRIy/9oACAEBAAEFAis51RhVrqL5/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAgMAAAAAAAAAAAAAAAAAARAAESH/2gAIAQEABj8CMpYX/8QAGhAAAwADAQAAAAAAAAAAAAAAAAERITFBEP/aAAgBAQABPyHYrb4iO0nldrCLKt1yGo//2gAMAwEAAgADAAAAEF//AP/EABcRAQADAAAAAAAAAAAAAAAAAAABETH/2gAIAQMBAT8QpGP/xAAWEQEBAQAAAAAAAAAAAAAAAAABADH/2gAIAQIBAT8QGdv/xAAdEAEAAgICAwAAAAAAAAAAAAABABEhQVGxYZGh/9oACAEBAAE/EHTZFkDzWXc+YQXlX7G9HQtK9Rw1yzFbnY7Z/9k='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"meme","title":"meme","src":"/static/a8023e440fa3cb4d7a930c3c378db219/1c72d/nodeModules.jpg","srcSet":["/static/a8023e440fa3cb4d7a930c3c378db219/a80bd/nodeModules.jpg 148w","/static/a8023e440fa3cb4d7a930c3c378db219/1c91a/nodeModules.jpg 295w","/static/a8023e440fa3cb4d7a930c3c378db219/1c72d/nodeModules.jpg 590w","/static/a8023e440fa3cb4d7a930c3c378db219/4b190/nodeModules.jpg 800w"],"sizes":["(max-width:","590px)","100vw,","590px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"流程步驟"}]},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"開發元件並透過"},{"type":"element","tagName":"a","properties":{"href":"https://storybook.js.org/"},"children":[{"type":"text","value":"Storybook"}]},{"type":"text","value":"UI開發工具預覽"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"透過"},{"type":"element","tagName":"a","properties":{"href":"https://webpack.js.org/"},"children":[{"type":"text","value":"Webpack"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"https://rollupjs.org/"},"children":[{"type":"text","value":"Rollup"}]},{"type":"text","value":" 等工具編譯打包"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"建立CICD, 每次push時自動發佈到Gitlab Registry"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"安裝至使用的專案"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"1. 開發元件"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"透過"},{"type":"element","tagName":"a","properties":{"href":"https://storybook.js.org/"},"children":[{"type":"text","value":"Storybook"}]},{"type":"text","value":"可以方便預覽每個元件的樣式與有什麼參數可以使用。例如按鈕元件，可以透過下方控制欄看出有什麼參數可以使用，與觸發時的樣式預覽。"}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; margin-left: 0; margin-right: 0;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/379030212b38fc97f7929946b64a3d35/2b608/storybook.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 63.51351351351351%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABpElEQVQ4y5VT226bQBDl0/PSKC9VP6X/UUVtpb5FiZM0Ni1gDIa9sNfTs2twVNuRkhFHs8DozJnZmWL1+IL7p9/YDRLKBkjj0UuFTklUGhAuYtIa1jkYY2HtwetpwmRMhrEWznmEEFGUdYt1tUXTjxi0y2hJ3tPfVRLPjUAMgcGn8P+9x5hAQkk1htks4ZnJO5vfo/fQSkNKyvyAFV++dfj80+DT94DrHx43xNVtwNeVPwalzO9F8eupwl0tsOocHvsEjweeK5kI44fIMmHdbNlYNtWH3Fib4fKZ/zNOLV76uJRc7/bY8kK6UWWIyWHkhWjjsDC+peZwGScKV89rrP/U6IXGnkiEB3iUElgLQHKclJRZuVJMKkQmu9Tf4m+zQ7Xt8vwlJKLkB/qXdkQlLJSLZ2MycRKGYX8sdVFbaAYnLMrkrG6yJO07BGfOlCRLw536v9ls0LbtMaZ4LdHNKg9nTULFDRlZnvP+Yv/c3AJjXpMWS6lHzAoTYdM0KMuS62YvElquGh8EJvRz0rcJqXQYhtyr85ITUcTeRO4/Y7XKapP9A21/9pkp0A6SAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Storybook","title":"Storybook","src":"/static/379030212b38fc97f7929946b64a3d35/fcda8/storybook.png","srcSet":["/static/379030212b38fc97f7929946b64a3d35/12f09/storybook.png 148w","/static/379030212b38fc97f7929946b64a3d35/e4a3f/storybook.png 295w","/static/379030212b38fc97f7929946b64a3d35/fcda8/storybook.png 590w","/static/379030212b38fc97f7929946b64a3d35/efc66/storybook.png 885w","/static/379030212b38fc97f7929946b64a3d35/c83ae/storybook.png 1180w","/static/379030212b38fc97f7929946b64a3d35/2b608/storybook.png 1540w"],"sizes":["(max-width:","590px)","100vw,","590px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"2.  透過Rollup編譯打包"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://rollupjs.org/"},"children":[{"type":"text","value":"Rollup"}]},{"type":"text","value":" 輕量的打包工具，只要有一個設定檔rollup.config.js, 執行rollup -c編譯就可以產出對應的輸出打包檔案。"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"rollup.config.js"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"js"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-js"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" resolve "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"@rollup/plugin-node-resolve\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" commonjs "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"@rollup/plugin-commonjs\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" peerDeps "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"rollup-plugin-peer-deps-external\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" terser "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"rollup-plugin-terser\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" postcss "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"rollup-plugin-postcss\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" typescript "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"@rollup/plugin-typescript\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" image "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"@rollup/plugin-image\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" babel "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"@rollup/plugin-babel\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" pkg "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"./package.json\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"const"}]},{"type":"text","value":" extensions "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\".js\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\".jsx\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\".ts\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\".tsx\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    input"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"./src/index.ts\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    output"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        file"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" pkg"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"main"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n        format"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"cjs\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        file"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" pkg"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"module"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n        format"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"esm\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    plugins"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"commonjs"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"resolve"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" extensions "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"peerDeps"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        includeDependencies"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean"]},"children":[{"type":"text","value":"true"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"terser"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"postcss"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"typescript"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"babel"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" babelHelpers"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"bundled\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" extensions "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"input程式進入點, output打包後檔案的檔名、路徑與輸出格式。"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\nplugins可以加入一些額外擴充功能"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"json"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-json"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-json"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"main\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"build/index.js\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"module\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"build/index.es.js\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"scripts\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"build\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"rollup -c\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  ...\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"遇到問題:"}]},{"type":"text","value":" "},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n@rollup/plugin-image在文件上寫說圖片都會被轉換成base64,會造成體積增加33%。"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n試著改用@rollup/plugin-url可以設定limit來將較大的圖片用圖檔的方式存在build資料夾內。"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n但是在專案內會遇到圖片顯示不出來，原因是圖片會到網域的根目錄(/)去拿，不是到node_modules/lib/build裡面拿。目前先繼續轉成base64。"}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"3. 發佈到Gitlab Registry"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"到 Settings > Access Token 新增 Project Access Tokens (將token加入環境變數)"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\ntoken可以到使用者的Edit Profile中註冊一個"}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; margin-left: 0; margin-right: 0;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/730d47ca7b7956a6b48487f04e04a373/bc3ae/accessToken.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 32.43243243243243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABAUlEQVQY021QWWrFMBDLpXuDnqL/Pc8jvJBQKE1iyObscfZNtdzmwaMdEGPLmvGMLKUUyrJE27ZPINc0DZI4RhgGmuseXF3XqKrqTw1hSSnhuq4RUEgURQHHcSDCEB+fAey7izyXsG0baZoiCAJ4nveoMfkX1jiO6LoOnPRC3/cGQ6+QlR2qRpnzpWPmpMzUKeqHwZwt/BPneWLf9+uG49if3o0VSYJY2zHP849qXXDqGmuaJmRZZvzJ89ysS5EQwjTmFFxpWRbQHkYURcYm+3ZDous28QX5+oL6/Q3WcRzYts1MdGVyg16BweZsxuZ8Z/DzUPvr+z5WzXG6NRLYColv7j7IjzbqQr8AAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Access Token","title":"Access Token","src":"/static/730d47ca7b7956a6b48487f04e04a373/fcda8/accessToken.png","srcSet":["/static/730d47ca7b7956a6b48487f04e04a373/12f09/accessToken.png 148w","/static/730d47ca7b7956a6b48487f04e04a373/e4a3f/accessToken.png 295w","/static/730d47ca7b7956a6b48487f04e04a373/fcda8/accessToken.png 590w","/static/730d47ca7b7956a6b48487f04e04a373/efc66/accessToken.png 885w","/static/730d47ca7b7956a6b48487f04e04a373/c83ae/accessToken.png 1180w","/static/730d47ca7b7956a6b48487f04e04a373/bc3ae/accessToken.png 1268w"],"sizes":["(max-width:","590px)","100vw,","590px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"設定CICD (Gitlab只要偵測到專案內有.gitlab-ci.yml就會執行對應的CICD)"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# .gitlab-ci.yml "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" node"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"12.20.0\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"stages"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" deploy\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"deploy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"stage"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" deploy\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"script"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" yarn publish"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"建立一個node環境並執行yarn publish。只要push時就會執行，可以在這裡設定成新增tag才執行推版動作。"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n當git push時觸發CICD，在Gitlab CI/CD的頁面就會像這樣，如果推版成功就會有綠色勾勾。"}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; margin-left: 0; margin-right: 0;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/045ded4cd1e20a1782c941d1675b251e/f4fb1/CICD.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 7.4324324324324325%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAQElEQVQI1zXFUQqAQAhAwe5/0dgIQ5FsV9sXBc3PLBrOajsjB6pK3gVRTO28/DC21hB1xE6YcGUnK/lFBCLy/QBF/E29MfSl8QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"CICD","title":"CICD","src":"/static/045ded4cd1e20a1782c941d1675b251e/fcda8/CICD.png","srcSet":["/static/045ded4cd1e20a1782c941d1675b251e/12f09/CICD.png 148w","/static/045ded4cd1e20a1782c941d1675b251e/e4a3f/CICD.png 295w","/static/045ded4cd1e20a1782c941d1675b251e/fcda8/CICD.png 590w","/static/045ded4cd1e20a1782c941d1675b251e/efc66/CICD.png 885w","/static/045ded4cd1e20a1782c941d1675b251e/c83ae/CICD.png 1180w","/static/045ded4cd1e20a1782c941d1675b251e/f4fb1/CICD.png 1766w"],"sizes":["(max-width:","590px)","100vw,","590px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"yarn publish會根據.yarnrc.yml設定檔來決定佈署的地方與權限設定"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# .yarnrc.yml"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"npmScopes"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"cnyes"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"npmPublishRegistry"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"${CI_API_V4_URL}/projects/${CI_PROJECT_ID}/packages/npm/\""}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"npmAlwaysAuth"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean","important"]},"children":[{"type":"text","value":"true"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"npmAuthToken"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"${NPM_AUTH_TOKEN}\""}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"CI開頭的變數名稱都是Gitlab內建的不用另外設定"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n這裡的"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"NPM_AUTH_TOKEN"}]},{"type":"text","value":"就會拿到上面的Access Token"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"執行yarn publish時，會依照package.json設定做打包。"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"json"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-json"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-json"]},"children":[{"type":"text","value":"# package.json\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"@cnyes/fe-share-components\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"files\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"build\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\".npmrc\""}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"publishConfig\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n\t"},{"type":"element","tagName":"span","properties":{"className":["token","property"]},"children":[{"type":"text","value":"\"@cnyes:registry\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"https://<gitlab-url>/api/v4/projects/<project-id>/packages/npm/\""}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"files定義需要打包哪些檔案"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"<gitlab-url>"}]},{"type":"text","value":"與"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"<project-id>"}]},{"type":"text","value":"輸入自己的gitlab網址與專案ID"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"如果有設定權限還需要設定npmrc"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"plain"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-plain"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-plain"]},"children":[{"type":"text","value":"# .npmrc\n@cnyes:registry=https://<gitlab-url>/api/v4/projects/<project-id>/packages/npm/\n//<gitlab-url>/api/v4/projects/<project-id>/packages/npm/:_authToken=<access-token>"}]}]}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"可能會稍微遇到一些問題，但應該都可以解掉…吧"}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; margin-left: 0; margin-right: 0;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/ee873b60f8b6c74d3ef7883c6cc10e18/11a8f/CICD_Error.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 105.40540540540542%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAABYlAAAWJQFJUiTwAAADNElEQVQ4y21V2ZKbMBDk//8tL6nKsbF3fWAw9y1OSZ0eYWC3ErZUWmBo9Uz3jD1dl5hvH9BFBgugKAqUZQm5rDYwfgdrrLvva4Xb5Ypn9ESQNbgnLepWQRsDO8/QdQXPqA66zCG7tRbzNGHmSyt/BDLl5HaBtNWEKsqR5hmSJEGWZYiiCF3XAQQ140BAAuimhhl6GAKO44iJzwTcSJCa3S73wzyiIouh76Fmi6o3WLkTT2uYeYIn7ObbO3Se7ilXVXWkfG33lJesx+N8gx88cH+EuD0i+I8AnVJ8yZSrggztmo4RAGOwXY6dsORbY40D1WSxZjBinBcM04J5WfZYwfFEjOn8GzqJ3AOpTZ7nK8OFgefGMZVrKDpcTxeEzxBBUuIalciK2oFaKR2z9QwFMDzRvE6SWu31k7XonQF6jaHt0bQNGtayZe2LIj9qzgxWldMYhkHCUFGxnkV3DEXleDhso3r4vo+c6sbVgEvSM229khBCxPJE4Tn0XUGFRV3XaNt2tYmIwo9kd/fliDoumGaG1NkmxfP5RCu20Qs0SXlObi77Sne79tSXowwTlRTbKKqqRk3bLFhe7F25uP4RJU1TlLTOV1HWj6ZM4f7nQsv4uPoR3v0YQRhhGAawI1y3Odvs6x/bGGen7X85QNIX+yziO6YpXbWLudlmvpygs2Q3ttRwN/bHYey+7HD6/Qd3/46Tn+HbKUGYlg7YCkNnbPFP17D1BsdSLLCIr+REYTYsa33luI6MuhGqV+go5qBaVBwkYnYXy2896WGZOLK7fiWwC9gAq2lnKM9jqltVJYp2QlRJx+hXLy/rcBCan3u5Zh83TXOk/DjG15L2CN7v7GWKcg9w8Z94BCFGMnO93HB8OX+91n87BXa3hDZ6TX0TDvgionzniRjT2w/oOHShMuOKz7Y51UfKaYu3779wfj/jdA3x84MMaRspxWGbT6y+GHubNvY1aGWnme1ssLBeE0FmzgCp+SaicQyZ9+xf3aQQODF1XdVHDQO1j7W+U/BvPidSjJgWuvEnoFXDCiYMpYama78Mh03lbTjYbNxTNuzl7EEwxkdxQsVT/gTEGCSe9TW0018xil/rNqcqMAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"CICD_Error","title":"CICD_Error","src":"/static/ee873b60f8b6c74d3ef7883c6cc10e18/fcda8/CICD_Error.png","srcSet":["/static/ee873b60f8b6c74d3ef7883c6cc10e18/12f09/CICD_Error.png 148w","/static/ee873b60f8b6c74d3ef7883c6cc10e18/e4a3f/CICD_Error.png 295w","/static/ee873b60f8b6c74d3ef7883c6cc10e18/fcda8/CICD_Error.png 590w","/static/ee873b60f8b6c74d3ef7883c6cc10e18/efc66/CICD_Error.png 885w","/static/ee873b60f8b6c74d3ef7883c6cc10e18/c83ae/CICD_Error.png 1180w","/static/ee873b60f8b6c74d3ef7883c6cc10e18/11a8f/CICD_Error.png 1272w"],"sizes":["(max-width:","590px)","100vw,","590px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"安裝至使用專案"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"sh"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-sh"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"yarn add @cnyes/fe-share-components"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"預設會到公開的地方下載套件，但是如果是到gitlab需要再設定"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":".npmrc"}]},{"type":"text","value":"來設定"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@cnyes"}]},{"type":"text","value":"這個群組名稱要去哪裡下載"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"plain"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-plain"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-plain"]},"children":[{"type":"text","value":"# .npmrc\n@cnyes:registry=https://<gitlab-url>/api/v4/projects/<project-id>/packages/npm/\n//<gitlab-url>/api/v4/projects/<project-id>/packages/npm/:_authToken=<access-token>"}]}]}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在元件內引入方式"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ts"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ts"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" Button "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'@cnyes/fe-share-components'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Reference"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://docs.gitlab.com/ee/user/packages/yarn_repository/"},"children":[{"type":"text","value":"Publish packages with Yarn | GitLab"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.youtube.com/watch?v=yvLxtkvsFDA"},"children":[{"type":"text","value":"(10) GitLab NPM Registry Demo - YouTube"}]}]},{"type":"text","value":"\n"}]}]},"frontmatter":{"title":"將UI元件庫發佈到Gitlab上","date":"March 02, 2023","description":null,"lastUpdate":"March 16, 2023"}}},"pageContext":{"slug":"/2023-03-02-publish-to-gitlab/Publish to gitlab registry/","previous":{"fields":{"slug":"/2023-02-03-husky/"},"frontmatter":{"title":"Husky"}},"next":{"fields":{"slug":"/2023-03-17-Leetcode/"},"frontmatter":{"title":"Bit Manipulation"}}}},"staticQueryHashes":["1990145124","2841359383"]}