---
title: "ES6-ES12"
date: "2021-08-31"
tags: ["JS"]
lastUpdate: "2023-01-16"
---
- [ECMAScript Language Specification](https://tc39.es/ecma262/)

# Content

- [ES6 (ECMAScript 2015)](#ES6)
- [ES7 (ECMAScript 2016)](#ES7)
- [ES8 (ECMAScript 2017)](#ES8)
- [ES9 (ECMAScript 2018)](#ES9)
- [ES10 (ECMAScript 2019)](#ES10)
- [ES11 (ECMAScript 2020)](#ES11)
- [ES12 (ECMAScript 2021)](#ES12)

<h1 id="ES6">ES6 (ECMAScript 2015)</h1>

### 1. let/const

**let**
‰ª•ÂâçÂú®ÂÆ£ÂëäËÆäÊï∏ÈÉΩ‰ΩøÁî®ÂÖ®ÂüüÁöÑ`var`Âú® ES6 Êñ∞Â¢û‰∫Ü`let`ÂèØ‰ª•Êõ¥ÊòéÁ¢∫ÁöÑË¶èÁØÑËÆäÊï∏‰ΩúÁî®ÁöÑÁØÑÂúç„ÄÇ

```js
function f() {
  let x = 1
  {
    console.log(x) // 1
    let y = 2
  }
  console.log(y) // Uncaught ReferenceError: y is not defined
}
f()
```

**const**
Á∞°Âåñ‰∫ÜÂÆöÁæ©Â∏∏Êï∏ÁöÑÂÆ£ÂëäÔºåÂ∏∏Êï∏ÂøÖÈ†àÂàùÂßãÂåñ‰∏î‰∏çËÉΩËÆäÊõ¥„ÄÇ

```js
const PI = 3.14
```

### 2. arrow functions

```js
var a = [1, 2, 3, 4, 5]
//ES5
a.map(function (v) {
  return v + 1
})
//ES6
a.map(v => v + 1)
```

### 3. classes

Âä†ÂÖ• classesÔºåÂÆöÁæ© class Êõ¥Áõ¥ËßÄ„ÄÇÂú® ES5 ‰ª•ÂâçÂÆöÁæ©Áâ©‰ª∂ÂæàË§áÈõúÔºåÊ≤íÊúâ class ÈóúÈçµÂ≠óÔºåÊâÄ‰ª•ÊúÉÁúãÂà∞ÂæàÂ§ö`XXX.prototype.YYY`ÁöÑË™ûÊ≥ïÔºåÂú® ES6 Âπæ‰πéÁúã‰∏çË¶ãÔºåÁ≤æÁ∞°Ë®±Â§ö„ÄÇ

- ES6 Âª∫Á´ã Stack Class

```js
class Stack {
  constructor() {
    this.stack = []
  }
  push(num) {
    this.stack.push(num)
  }
  pop() {
    return this.stack.pop()
  }
  size() {
    return this.stack.length
  }
}

s = new Stack()
s.push(1)
s.push(2)
s.push(3)
s.pop() // 3
s.size() // 2
```

- ES6 ‰πãÂâçÁöÑÂØ´Ê≥ï

```js
const Stack = function () {
  this.stack = []
}
Stack.prototype.push = function (num) {
  this.stack.push(num)
}
Stack.prototype.pop = function () {
  return this.stack.pop()
}
Stack.prototype.size = function () {
  return this.stack.length
}
```

- ÁπºÊâøÂØ´Ê≥ï

```js
class Animal {
  constructor(name, leg) {
    this.name = name
    this.leg = leg
  }
  bark() {
    console.log("animal bark")
  }
}
class Cat extends Animal {
  constructor({ name, leg }) {
    super(name, leg)
    this.run = true
    this.fly = false
  }
  bark() {
    console.log("meow")
  }
}

let cat = new Cat({ name: "Jack", leg: 4 })
cat // Cat¬†{name: "Jack", leg: 4, run: true, fly: false}
cat.bark() // meow
```

### 4. template string

ÂÖÅË®±Âú®Â≠ó‰∏≤‰∏≠ÊèíÂÖ•ËÆäÊï∏Ôºå‰∏çÁî®ÂÉè‰ª•Ââç‰∏ÄÊ®£ÂÅöÂ≠ó‰∏≤‰∏≤Êé•„ÄÇ

```js
let name = "Tom"
let template = `Hello, ${name}.` // "Hello, Tom."
```

### 5. destructuring

Âú®ÊãÜËß£Èô£ÂàóÊàñÊòØÁâ©‰ª∂ÊôÇÊõ¥Êñπ‰æø

```js
let num = [1, 2, 3]
let [a, b, c] = num // a = 1, b = 2, c = 3
```

```js
let obj = { a: 1, b: 2, c: 3 }
let { a, b, c } = obj
console.log(a, b, c) // 1, 2, 3
```

### 6. default + rest + speard

- default

  Âú®ÂÇ≥ÈÅûÂèÉÊï∏ÂÖÅË®±Ë®≠ÂÆöÈ†êË®≠ÂÄºÔºåËÉΩÂ§†È†êÈò≤‰∏Ä‰∫õ‰æãÂ§ñÁî¢Áîü
  e.g.

```js
let f = (a = 1, b = 2, c = 3) => {
  console.log(a, b, c)
}
f() // 1 2 3
f(4, 5) // 4 5 3
f(4, 5, 6) // 4 5 6
```

- rest

  Âú®‰ΩøÁî®ÂáΩÊï∏ÊàñÊòØË®≠Ë®àÂáΩÊï∏‰∏äÂèØËÉΩÊúÉÈÅá‰∏ä‰∏çÁ¢∫ÂÆöÂà∞Â∫ïË¶ÅÂπæÂÄãÂèÉÊï∏Ôºå
  ES6 ÂèØ‰ª•ËÆì‰Ω†Âú®ÈÄôÊñπÈù¢Êõ¥ÊúâÂΩàÊÄß„ÄÇ‰∏çÁ¢∫ÂÆöÁöÑÂèÉÊï∏‰ΩøÁî®`...p`‰ΩúË°®Á§∫Ôºåp ÁÇ∫‰∏ÄÂÄãÈô£Âàó„ÄÇ

```js
let f = (a, ...rest) => {
  console.log(a, rest)
}
f(1, 2, 3, 4, 5) // 1 [2, 3, 4, 5]
```

- spread

```js
let arr1 = [1, 2, 3]
let arr2 = [4, 5, 6]
let arr3 = [...arr1, ...arr2] // [1, 2, 3, 4, 5, 6]
```

### 7. iterators + for..of

```js
let nums = [1, 2, 3, 4]
for (let n of nums) {
  console.log(n)
}
/*
	1
	2
	3
	4
*/
```

### 8. Generators
* ‰∏ÄËà¨function
```js
  function f() {
      console.log('1.')
      console.log('2.')

      return 'Hello World'
  }
```
* generator function\
ÊúÉÂú®function‰øùÁïôÂ≠óÂæåÈù¢Âú®Âä†‰∏äÊòüËôü(*)\
generator functionÂõûÂÇ≥ÂÄºÊòØgenerator object, ÊòØ‰∏ÄÂÄãiterator\
genertaor functionÂÖß‰ΩøÁî®`yield`‰æÜÊö´ÂÅúÂü∑Ë°å„ÄÇ
```js
  function* f() {
      yield 'yield 1.'
      console.log('1.')

      yield 'yield 2.'
      console.log('2.')

      return 'Hello World'
  }

  const iter = f()
  iter.next() // {value: 'yield 1.', done: false}
  iter.next() // {value: 'yield 2.', done: false}
  iter.next() // {value: 'Hello World', done: true}
```

```js
function* f() {
  yield 'a'
  yield 'b'
  yield 'c'
  yield 'd'
}

const iter = f()
console.log([...iter]) // [a, b, c, d]
```

* Reference
  - [üí°üéÅ JavaScript Visualized: Generators and Iterators - DEV Community üë©‚Äçüíªüë®‚Äçüíª](https://dev.to/lydiahallie/javascript-visualized-generators-and-iterators-e36)
  - [ES6 Generator Âü∫Á§é #1](https://github.com/aszx87410/blog/issues/1)

### 9. unicode

```js
s = "\u{1F602}" //"üòÇ"
```

### 10. modules

```js
// a.js
const a = () => {
  console.log("a.js")
}
module.exports = a
```

```js
// b.js
import a from "./a"
a() // a.js
```

### 11. map/set/weakmap/weakset

- map / [weakmap](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap)

  Map ÁöÑ key ÂÄºÂèØ‰ª•ÊòØ‰ªªÊÑèÂûãÊÖã(int, string, array) \
  WeakMap ÁöÑ key ÂÄºÂè™ËÉΩÊòØÁâ©‰ª∂

```js
let map = new Map()
map.set(1, "1")
map.set("a", "a")
map.set(["arr1"], ["arr2"])
map // {1 => "1", "a" => "a", ["arr1"] => ["arr2"]}

let weakmap = new WeakMap()
weakmap.set(1, "1")
// Uncaught TypeError: Invalid value used as weak map key
weakmap.set("a", "a")
// Uncaught TypeError: Invalid value used as weak map key
weakmap.set(["arr1"], ["arr2"]) // {["arr1"] => ["arr2"]}
```

- set / [weakset](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet)

Set Ëàá WeakSet Â∑ÆÁï∞: Set ËÉΩÂ§†ÂÑ≤Â≠òÈö®ÊÑèÂûãÊÖã(int, string, array), WeakSet Âè™ËÉΩÂ§†ÂÑ≤Â≠òÁâ©‰ª∂„ÄÇ

```js
let set = new Set()
set.add(1).add(2).add(5) // {1, 2, 5}
set.add(2) // {1, 2, 5}
set.add("2") // // {1, 2, 5, "2"}
set.add([1, 2, 3]) // {1, 2, 5, "2", [1,2,3]}
set.size // 5

let weakset = new WeakSet()
weakset.add(1)
// Uncaught TypeError: Invalid value used in weak set
weakset.add([1, 2, 3]) // {[1,2,3]}
weakset.add([1, 2, 3]) // {[1,2,3], [1,2,3]}
```

### 12. proxying/refection

### 13. symbols

symbol ÊòØ ES6 Êñ∞Â¢ûÁöÑ‰∏ÄÁ®ÆÂü∫Êú¨Êï∏ÊìöÂûãÊÖã(primitive data type)„ÄÇ\
Âü∫Êú¨ÂûãÊÖãÊúâ‰∏ÉÁ®Æ: stringÔºånumberÔºåbigintÔºåbooleanÔºånullÔºåundefinedÔºåsymbol„ÄÇ\
ÁâπÊÄß: **ÂîØ‰∏Ä**‰∏î‰∏çÂèØÊîπËÆä(immutable)ÁöÑË≥áÊñôÂûãÊÖãÔºåÂèØÁî®‰æÜË≠òÂà•Áâ©‰ª∂ÁöÑÂ±¨ÊÄß„ÄÇ

```js
let a = Symbol("123")
let b = Symbol("123")
a === b // false
```

```js
let a = Symbol("aaa")
let b = Symbol("bbb")
let obj = { [a]: 123, [b]: 456 }
obj // {Symbol(aaa): 123, Symbol(bbb): 456}
```

### 14. promises

Á®ãÂºèÂ∏∏Â∏∏ÈúÄË¶ÅÂÅö request Âà∞ÂæåÁ´Ø‰æÜÂèñÂæóË≥áÊñôÔºå‰ΩÜ server ‰∏¶‰∏çÊúÉÈ¶¨‰∏äÂõûÂÇ≥Ë≥áÊñôÔºåË¶ÅÁ≠âÂæÖ server ËôïÁêÜÁöÑÊôÇÈñì„ÄÇÈÄôÊôÇÁ®ãÂºèÂ∞±ÂøÖÈ†àÂÅú‰∏ã‰æÜÁ≠âÂæÖÔºåÈÄ†ÊàêÊôÇÈñìÊµ™Ë≤ª„ÄÇ

ES6 ÊèêÂá∫‰∫Ü promise ‰æÜËß£Ê±∫ÈÄôÂÄãÈùûÂêåÊ≠•(asynchronously)ÁöÑÁãÄÊ≥Å„ÄÇÁï∂ÁôºÈÄÅ request Âà∞ server ÂæåÔºå‰∏¶‰∏çÊúÉÂÅú‰∏ã‰æÜÁ≠â server ËôïÁêÜÂÆåÔºåËÄåÊòØÁïô‰∏ã callback ÂæåÔºåÁπºÁ∫åÂü∑Ë°åÂæåÈù¢‰ªªÂãô„ÄÇ

Áï∂ server ÊàêÂäüËôïÁêÜÂ•ΩÊãøÂà∞Ë≥áÊñôÊ∫ñÂÇôÂõûÂÇ≥ÊôÇÔºåÂÜçÂéªÂü∑Ë°åÂâõÂâõÁïô‰∏ãÁöÑ callback function„ÄÇÁïô‰∏ãÁöÑ callback function ÊúâÂàÜÁÇ∫ request ÂëºÂè´ÊàêÂäü(resolve)Ëàá request ÂëºÂè´Â§±Êïó(reject)„ÄÇ

```js
const callServer = time => {
  return new Promise((resolve, reject) => {
    if (time <= 300) {
      setTimeout(() => resolve({ msg: "request success!" }), time)
    } else {
      setTimeout(() => reject({ msg: "request failed!" }), time)
    }
  })
}
callServer(200).then(res => console.log(res))
// {msg: "request success!"}
callServer(400)
  .then(res => console.log(res))
  .catch(e => console.log(e)) // <--
// {msg: "request failed!"}
```

### 15. binary and octal literals

ÊîØÊè¥‰∫åÈÄ≤‰ΩçËàáÂÖ´ÈÄ≤‰ΩçË°®Á§∫

```js
0b111 //7
0o123 //83
```

```js
let num = "1010"
let binNum = `0b${num}`
let decNum = BigInt(binNum) // 10n
decNum.toString(2) // "1010"
```

- [Leetcode #67](https://leetcode.com/problems/add-binary/)

<h1 id="ES7">ES7 (ECMAScript 2016)</h1>

### 1. Exponentiation Operator

```js
2 ** 3 // 8
```

### 2. Array.includes()

```js
let arr = ["Tom", "Jack", "David"]
arr.includes("Tom") // true
```

<h1 id="ES8">ES8 (ECMAScript 2017)</h1>

### 1. Async functions [(MDN)](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Statements/async_function)

ÂèØ‰ª•Áî®‰æÜÁ∞°Âåñ ES6 Promise ÂØ´Ê≥ïÔºåawait Ë°®ÈÅîÂºèÂè™ËÉΩÂú® async ÂáΩÂºèÂÖßÈÉ®‰ΩøÁî®Ôºåawait ÊúÉÁ≠âÂæÖ Promise Ëß£ÊûêÂÆåÁï¢ÊâçÊúÉÁπºÁ∫åÂæÄ‰∏ãÂü∑Ë°å„ÄÇ

‰πãÂâç ES6 Promise ÁØÑ‰æãÔºåÂú® callServer()‰πãÂæåË¶ÅËôïÁêÜÂõûÂÇ≥ÁöÑ Promise ÈúÄË¶Å‰ΩøÁî®`.then()`‰æÜÊé•„ÄÇËã•ÊãøÂõû‰æÜÁöÑË≥áÊñôÈÇÑË¶ÅÁï∂ÂÅöÂÖ∂‰ªñ function ÁöÑ input ÊúÉÈÅáÂà∞`.then().then().then()`ÁöÑÁãÄÊ≥Å„ÄÇ

```js
const callServer = time => {
  return new Promise((resolve, reject) => {
    if (time <= 300) {
      setTimeout(() => resolve({ msg: "request success!" }), time)
    } else {
      setTimeout(() => reject({ msg: "request failed!" }), time)
    }
  })
}
callServer(200).then(res => console.log(res))
// {msg: "request success!"}
callServer(400)
  .then(res => console.log(res))
  .catch(e => console.log(e)) // <--
// {msg: "request failed!"}
```

ES8 async function ÂèØ‰ª•ÊîπÂñÑËôïÁêÜ promise ÁöÑÂØ´Ê≥ï„ÄÇ

```js
const callServer = time => {
  return new Promise((resolve, reject) => {
    if (time <= 300) {
      setTimeout(() => resolve({ msg: "request success!" }), time)
    } else {
      setTimeout(() => reject({ msg: "request failed!" }), time)
    }
  })
}
const run = async () => {
  let success = await callServer(200)
  let error = {}
  try {
    error = await callServer(400)
  } catch (err) {
    error = err
  }

  console.log(success) // {msg: "request success!"}
  console.log(error) // {msg: "request failed!"}
}
run()
```


*  [‚≠êÔ∏èüéÄ JavaScript Visualized: Promises & Async/Await - DEV Community üë©‚Äçüíªüë®‚Äçüíª](https://dev.to/lydiahallie/javascript-visualized-promises-async-await-5gke) 

### 2. Object.entries

```js
let obj = { a: 1, b: 2, c: 3 }

for (let [key, value] of Object.entries(obj)) {
  console.log(key, value)
}
/*
  a 1
  b 2
  c 3
*/
```

### 3. Object.values

```js
let obj = { a: 1, b: 2, c: 3 }

for (let value of Object.values(obj)) {
  console.log(value)
}
/*
  1
  2
  3
*/
```

### 4. Object.getOwnPropertyDescriptors

```js
let obj = { a: 1, b: 2, c: 3 }

let descriptors = Object.getOwnPropertyDescriptors(obj)

descriptors

/*
{
  a: {value: 1, writable: true, enumerable: true, configurable: true}
  b: {value: 2, writable: true, enumerable: true, configurable: true}
  c: {value: 3, writable: true, enumerable: true, configurable: true}
}
*/
```

### 5. String.padStart() [(MDN)](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/String/padStart), String.padEnd() [(MDN)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/padEnd)

- String.padStart()

  > str.padStart(targetLength [, padString])

```js
"101".padStart(8) // "     101"
"101".padStart(8, "0") // "00000101"
"101".padStart(8, "xyz") // "xyzxy101"
```

- String.padEnd()

```js
"101".padEnd(8) // "101     "
"101".padEnd(8, "0") // "10100000"
"101".padEnd(8, "xyz") // "101xyzxy"
```

### 6. Shared memory and Atomic

- [tc39/ecmascript_sharedmem](https://github.com/tc39/ecmascript_sharedmem/blob/master/TUTORIAL.md)
- [Web Workers](https://developer.mozilla.org/zh-TW/docs/Web/API/Web_Workers_API/Using_web_workers)

![shared-memory](./shared-memory.png)

Atomic ÊòØÈ°û‰ººÈéñÔºåÁï∂ CPU1 Âú®ËÆÄÂØ´ shared memory ÊôÇÔºåÊúÉÊää shared memory ‰∏≠ÁöÑÂÄºË§áË£Ω‰∏Ä‰ªΩÂà∞ cache ‰∏≠„ÄÇÂú®ËÆÄÂØ´ÊôÇÊää shared memory Èéñ‰ΩèÔºåËÆìÂÖ∂‰ªñ CPU ‰∏çËÉΩÂ§†ËÆÄÂØ´ÔºåÈÅøÂÖçË§áË£ΩÂà∞ËàäÁöÑÂÄºÔºåÁ¢∫‰øùË≥áÊñô‰∏ÄËá¥ÊÄß„ÄÇ

<h1 id="ES9">ES9 (ECMAScript 2018)</h1>

### 1. Object rest and spread

Âú® ES6 Âä†ÂÖ•ÁöÑ rest Ëàá spread Âè™ËÉΩÈáùÂ∞çÈô£ÂàóÂÅöÂ±ïÈñãÔºåES8 Êì¥Â±ïÂà∞‰πüËÉΩÂ§†ÈáùÂ∞çÁâ©‰ª∂Â±ïÈñã„ÄÇ

```js
let obj = { a: 1, b: 2, c: 3 }
let { a, ...rest } = obj
a // 1
rest // {b: 2, c: 3}
```

### 2. Promise.finally

‰∏çÁÆ° Promise ÊòØ resolve ÈÇÑÊòØ reject ÈÉΩÊúÉÂü∑Ë°å finally()ÔºåÂèØ‰ª•Áî®‰æÜÈóúÈñâ loading ÁãÄÊÖã„ÄÇ

```js
const fetchData = time => {
  return new Promise((resolve, reject) => {
    if (time <= 300) {
      setTimeout(() => resolve({ data: "request success" }), time)
    } else {
      setTimeout(() => reject({ data: "request failed!" }), time)
    }
  })
}

const run = async () => {
  fetchData(400)
    .then(({ data }) => console.log(data))
    .catch(err => console.log(err))
    .finally(() => console.log("finally"))
}
run()

// {data: "request failed!"}
// finally
```

### 3. Asynchronous Iteration

ÊîØÊè¥Âú® for Ëø¥ÂúàÂÖßÂëºÂè´ÈùûÂêåÊ≠• function„ÄÇ

```js
const fetchData = time => {
  return new Promise((resolve, reject) => {
    setTimeout(() => resolve(`success: ${time}ms`), time)
  })
}

const run = async () => {
  let times = [500, 1000, 2000]
  for await (let ms of times) {
    fetchData(ms).then(res => console.log(res))
  }
}
run()
// success: 500ms
// success: 1000ms
// success: 2000ms
```

### 4. Regular Expression Features

- Named capture groups\
  Âú®Ê≠£Ë¶èË°®ÈÅîÂºèÂÖß‰ΩøÁî®`?<name>`‰æÜÂπ´ group ÂèñÂêçÂ≠ó

```js
const re = /(?<year>[0-9]{4})-(?<month>[0-9]{2})-(?<day>[0-9]{2})/
const match = re.exec("2021-09-05")
match.groups // {year: "2021", month: "09", day: "05"}
```

- dotAll\
  [tc39/proposal-regexp-dotall-flag](https://github.com/tc39/proposal-regexp-dotall-flag)

  `.`Âú®Ê≠£Ë¶èË°®ÈÅîÂºè‰∏≠‰ª£Ë°®‰ªªÊÑèÂ≠óÂÖÉÔºå‰ΩÜ‰∏çËÉΩÊòØÊèõË°åÁ¨¶Ëôü(line terminator)

  ```c
  /foo.bar/.test("fooAbar") // true
  /foo.bar/.test("foo\nbar") // false
  ```

  Âª∫Ë≠∞Ëß£Ê±∫ÊñπÊ°à\
  Â¢ûÂä† s flagÔºåËÆì`.`ËÉΩÂ§†ÂåπÈÖç‰ªª‰ΩïÂ≠óÂÖÉÂåÖÂê´ÊèõË°åÁ¨¶Ëôü

  ```c
  /foo.bar/s.test("foo\nbar") // true
  ```

- lookbehind assertions \
  [tc39/proposal-regexp-lookbehind](https://github.com/tc39/proposal-regexp-lookbehind)

  - Positive `(?<=...)`\
    `(?<=x)y`Ë°®Á§∫ x ÂæåÈù¢Êé•Ëëó yÔºåÊâçÊúÉÂåπÈÖç y
    ```js
    let re = /(?<=\$)\d+\.\d+/
    re.exec("$10.53")
    // ["10.53", index: 1, input: "$10.53", groups: undefined]
    re.exec("‚Ç¨10.53") // null
    ```
  - Negative `(?<!...)`\
    `(?<!x)y`Ë°®Á§∫ x ÂæåÈù¢‰∏çÊòØ yÔºåÊâçÊúÉÂåπÈÖç y

- Unicode property escapes\
   [tc39/proposal-regexp-unicode-property-escapes](https://github.com/tc39/proposal-regexp-unicode-property-escapes)
  ```js
  const regexGreekSymbol = /\p{Script=Greek}/u
  regexGreekSymbol.test("œÄ") // true
  ```

### 5. Escape sequences allowed in tagged template literals

```js
const tagged = (s, version, year) => {
  console.log(s)
  console.log(version)
  console.log(year)
}

let version = "ES9"
let year = 2018

console.log(tagged`This is ${version} (ECMAScript${year}).`)
/* 
  ["This is ", " (ECMAScript", ").", raw: Array(3)]
  ES9
  2018
*/
```

<h1 id="ES10">ES10 (ECMAScript 2019)</h1>

### 1. Array.flat() [(MDN)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flat) / Array.flatMap() [(MDN)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap)

- flat(deep)

```js
let arr1 = [1, 2, [3, 4]]
arr1.flat() // [1, 2, 3, 4]

let arr2 = [1, 2, [3, 4, [5, 6]]]
arr2.flat() // [1, 2, 3, 4, [5, 6]]
arr2.flat(2) // [1, 2, 3, 4, 5, 6]

let arr3 = [1, 2, [3, 4, [5, 6, [7, 8, [9, 10]]]]]
arr3.flat(Infinity) // [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
```

- flatMap()\
  Âíå map()Â∑ÆÂú® map()ÂÆåÊúÉÂÜçÁ∂ìÈÅé‰∏ÄÂ±§ÁöÑ flat()Â±ïÈñã„ÄÇ

### 2. Object.fromEntries()[(MDN)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries)

Êää Map„ÄÅArray ÂÇ≥ÊèõÊàêÁâ©‰ª∂„ÄÇ

```js
const map = new Map([
  ["a", 1],
  ["b", 2],
])
map // Map(2)¬†{'a' => 1, 'b' => 2}
Object.fromEntries(map) // {a: 1, b: 2}
```

```js
let arr = [
  ["a", 1],
  ["b", 2],
  ["c", 3],
]
Object.fromEntries(arr) // {a: 1, b: 2, c: 3}
```

### 3. String.trimStart() / String.trimEnd()

ÂéªÈô§Â∑¶ÈÇä/Âè≥ÈÇäÁ©∫ÁôΩ‰∏¶ËøîÂõû‰∏ÄÂÄãÊñ∞ÁöÑÂ≠ó‰∏≤Ôºå‰∏çÊúÉÁõ¥Êé•‰øÆÊîπÂéü‰æÜÁöÑÂÄº„ÄÇ

```js
let s = "   hello   "
s.trimStart() // 'hello   '
s.trimEnd() // '   hello'
```

<h1 id="ES11">ES11 (ECMAScript 2020) </h1>

### 1. string.matchAll() [(MDN)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/matchAll)

```js
let s = "abcdacd"
console.log([...s.matchAll(/a/g)])
/*
[
  ['a', index: 0, input: 'abcdacd', groups: undefined],
  ['a', index: 4, input: 'abcdacd', groups: undefined]
]
*/
```

### 2. BigInt

ÈÅáÂà∞È°û‰ºº[Leetcode 1985](https://leetcode.com/problems/find-the-kth-largest-integer-in-the-array/)ÈÄôÈ°ûÂïèÈ°åÔºå
Number ÂûãÊÖãÂ∑≤Á∂ì‰∏çË∂≥Â§†Ë°®Á§∫„ÄÇNumber ÂûãÊÖãË°®Á§∫‰∏äÈôêÁÇ∫$2^{53} - 1$„ÄÇ

```js
Math.pow(2, 53) // 9007199254740992
Number.MAX_SAFE_INTEGER // 9007199254740991

Number.MAX_SAFE_INTEGER + 1 // 9007199254740992
Number.MAX_SAFE_INTEGER + 2 // 9007199254740992

BigInt(Number.MAX_SAFE_INTEGER) + BigInt(1) // 9007199254740992n
BigInt(Number.MAX_SAFE_INTEGER) + BigInt(2) // 9007199254740993n
```

### 3. Promise.allSettled

Promise.all() Âú®ÈÅáÂà∞ reject ÊôÇÊúÉÂÅúÊ≠¢ÂæåÁ∫åÂãï‰Ωú(short-circuit)ÔºåÁõ¥Êé•Âô¥ÈåØ„ÄÇ\
Promise.allSettled() ÂÖ∂‰∏≠ÊúâÈÅáÂà∞ reject ÈÇÑÊòØÊúÉÂ∞áÂÖ∂‰ªñ promise Âü∑Ë°åÂÆåÁï¢„ÄÇ

```js
let promise1 = Promise.resolve(3)
let promise2 = new Promise((resolve, reject) => {
  setTimeout(reject("error"))
})
let promise3 = 42

Promise.all([promise1, promise2, promise3])
  .then(values => {
    console.log(values)
  })
  .catch(() => console.log("error"))
// error

Promise.allSettled([promise1, promise2, promise3]).then(values => {
  console.log(values)
})
/*
[
  { status: 'fulfilled', value: 3 },
  { status: 'rejected', reason: 'error' },
  { status: 'fulfilled', value: 42 }
]
*/
```

### 4. globalThis

```c
var a = 10 // Window{..., a: 10, ...}

(function () {
  let a = 20
  console.log(a) // 20
  console.log(this.a) // 10
  console.log(window.a) // 10
  console.log(frames.a) // 10
  console.log(globalThis.a) // 10
})()
```

### 5. Nullish coalescing Operator (??) [(MDN)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator)

`??`Â∑¶ÂÅ¥ÁÇ∫Âê¶ÂÆöÂè™Âà§Êñ∑`null`Âíå`undefined`

```js
console.log(null ?? "hello") // hello
console.log(undefined ?? "hello") // hello
console.log(false ?? "hello") // false
console.log(0 ?? "hello") // 0
console.log("" ?? "hello") // ""

console.log(null || "hello") // hello
console.log(undefined || "hello") // hello
console.log(false || "hello") // hello
console.log(0 || "hello") // hello
console.log("" || "hello") // hello
```

### 6. Optional Chaining (?.)

```js
let a = {
  b: {
    c: 1,
  },
}
a.b.c // 1
a.d.c // TypeError: Cannot read properties of undefined
a?.d?.c // undefined
```

### 7. module

- import()\
  ÊîØÊè¥ÂãïÊÖãËºâÂÖ•ÔºåÂèØÂú®ÈúÄË¶ÅÊôÇÊâç import„ÄÇ
- import.meta
- export \* as ns from 'module'

<h1 id="ES12">ES12 (ECMAScript 2021) </h1>

### 1. replaceAll

```js
let str = "ABCDFABCGHIABC"
str.replaceAll("ABC", "xxx") // 'xxxDFxxxGHIxxx'
```

```js
str.replace(/ABC/g, "xxx") // 'xxxDFxxxGHIxxx'
```

### 2. [Promise.any](https://github.com/tc39/proposal-promise-any)

> a Promise combinator that short-circuits when an input value is fulfilled (ÈÅáÂà∞ÁöÑÁ¨¨‰∏ÄÂÄã Promise ÊòØ fullilled Â∞±ÂõûÂÇ≥,ÂæåÈù¢ÁöÑÈÉΩ‰∏çÂÅö‰∫Ü)

- Promise.all

  ÊâÄÊúâÁöÑ Promise ÈÉΩË¶Å fulfilled Âê¶ÂâáÂ†±ÈåØ

- Promise.allSettled

  ÈÅáÂà∞ Promise ÊòØ rejected ÈÇÑÊòØÊúÉÊääÂæåÈù¢ÁöÑ Promise ÂÅöÂÆå

- Promise.any

  ÊúÉÂÇ≥Á¨¨‰∏ÄÂÄã fulfilled ÁöÑ PromiseÔºå‰πãÂæåÁöÑ Promise ‰∏çÂü∑Ë°å„ÄÇ\
  Ëã•ÂÖ®ÈÉ®ÈÉΩÊòØ rejected ÂâáÂ†±ÈåØ(`Uncaught (in promise) AggregateError: All promises were rejected`)

### 3. AggregateError

> a new Error type to represent multiple errors at once (‰∏ÄÂÄãÊñ∞ÁöÑ Error type, ÊääÂ§öÂÄã Errors ÂåÖÂú®‰∏ÄËµ∑)

```js
Promise.any([
  Promise.reject("error1"),
  Promise.reject("error2"),
  Promise.reject("error3"),
]).catch(err => err)

/*
AggregateError{
  errors: (3) ['error1', 'error2', 'error3']
  message: "All promises were rejected"
  stack: "AggregateError: All promises were rejected"
}
*/
```

### 4. `??=`, `&&=`, `||=`

```js
let a = undefined
let b = 1

a ??= b // Â¶ÇÊûúaÊòØnullish(null, undefined), Â∞ábË≥¶ÂÄºÂà∞a
```

```js
let a = 1
a &&= 10 // Â¶ÇÊûúaÊòØtruthy,ÂâáË≥¶ÂÄºÂà∞a (a = 10)

let b = 0
b &&= 10 // Â¶ÇÊûúbÊòØfalsy,Ââá‰∏çË≥¶ÂÄº (b = 0)
```

```js
let a = 1
a ||= 10 // Â¶ÇÊûúaÊòØtruthy,Ââá‰∏çË≥¶ÂÄº (a = 0)

let b = 0
b ||= 10 // Â¶ÇÊûúbÊòØfalsy,ÂâáË≥¶ÂÄºÂà∞b (b = 10)
```

### 5. WeakRef

> for referring to a target object without preserving it from garbage collection

### 6. FinalizationRegistry

> to manage registration and unregistration of cleanup operations performed when target objects are garbage collected (Âú®Ë®ªÂÜäÁöÑÁâ©‰ª∂Ë¢´ÂõûÊî∂ÊôÇ,Âü∑Ë°å callback)

```c
const r = new FinalizationRegistry(
  () => console.log("callback")
);

(() => {
  let obj = { a: 1, b: 2 }
  r.register(obj)
})();
```
